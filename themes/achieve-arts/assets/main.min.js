(()=>{"use strict";(()=>{let e,t,n;function s(e){e.forEach(e=>{e.isIntersecting&&(e.target.classList.add("js-anim__visible"),n.unobserve(e.target))})}const o=".js-video";let i,a,r,l,c;function d(e){if("false"===e.dataset.autoplay)return!1;const t=window.matchMedia?.("(prefers-reduced-motion: reduce)").matches;return!t}function u(e){e.hasAttribute("muted")||(e.muted=!0),e.hasAttribute("playsinline")||e.setAttribute("playsinline",""),"true"===e.dataset.unmute&&(e.muted=!1)}function m(e){if(e.hasAttribute("data-loaded"))return;const t=Array.from(e.children).filter(e=>"SOURCE"===e.tagName);let n=!1;for(const e of t){const t=e.getAttribute("data-src");t&&(e.src=t,e.removeAttribute("data-src"),n=!0)}if(n&&e.load(),!e.hasAttribute("data-loaded")){const t=()=>{e.setAttribute("data-loaded","true"),e.removeEventListener("loadedmetadata",t)};e.addEventListener("loadedmetadata",t,{once:!0})}}async function b(e){if(e.paused||e.ended)try{await e.play()}catch(e){console.debug("Video play() blocked or failed:",e?.name||e)}}function v(e){e.forEach(e=>{const t=e.target;if(e.isIntersecting){if(m(t),!d(t))return;u(t),t.classList.add("js-video__visible"),t.parentElement?.classList.add("js-video-ready"),b(t)}else t.classList.remove("js-video__visible"),t.paused||t.pause()})}function f(){const e=document.querySelectorAll(o);document.hidden&&e.forEach(e=>{e.paused||e.pause()})}let h,p=!1;function y(){document.body.classList.add("mobile-nav-primer"),clearTimeout(h),h=setTimeout(()=>{document.body.classList.add("mobile-nav-open"),p=!1},300)}function g(){p||(p=!0,document.body.classList.contains("search-pane-open")?y():document.body.classList.contains("mobile-nav-open")?(clearTimeout(h),document.body.classList.remove("mobile-nav-open"),setTimeout(()=>{document.body.classList.remove("mobile-nav-primer"),p=!1},300)):y())}function L(){a=document.querySelector(".js-mobile-nav"),l=document.querySelector(".js-mobile-nav__burger"),a?(r=[...a.querySelectorAll(".js-mobile-nav__toggle")],c=[...a.querySelectorAll(".js-mobile-nav__close")]):(r=[],c=[]),a?(l?l.addEventListener("click",g):console.warn("Expected .js-mobile-nav__burger element is missing."),r.length&&r.forEach(e=>{e.closest(".menu-item").addEventListener("click",function(e){e.target.closest(".menu-item").classList.contains("menu-item-has-children")&&(e.stopPropagation(),e.preventDefault(),function(e){if(p)return;const t=e,n=t.querySelector(".sub-menu");if(n){if(n.style.transition="height 300ms ease-in-out",t.classList.contains("sub-menu__open"))n.style.height="0",n.addEventListener("transitionend",()=>{n.style.transition="",n.style.height="",t.classList.remove("sub-menu__open")},{once:!0});else{const e=n.scrollHeight+"px";n.style.height=e,t.classList.add("sub-menu__open"),n.addEventListener("transitionend",()=>{n.style.transition=""},{once:!0})}p=!1}}(e.currentTarget))})}),c.length&&c.forEach(e=>{e.addEventListener("click",function(){g()})})):console.warn("Expected .js-mobile-nav element is missing.")}window.addEventListener("DOMContentLoaded",()=>{n&&(n.disconnect(),n=null),e=[...document.querySelectorAll(".js-anim")],e.length&&("IntersectionObserver"in window?(t={root:null,rootMargin:"0px",threshold:.25},n=new IntersectionObserver(s,t),e.forEach(e=>{e&&e instanceof Element?n.observe(e):console.error("Invalid DOM element",e)})):(console.error("Intersection Observer API is not available. Fallbacks are being used."),e.forEach(e=>e.classList.add("js-anim__visible")))),L(),function(){const e=Array.from(document.querySelectorAll(o)).filter(e=>e instanceof HTMLVideoElement);if(!e.length)return console.warn(`No video elements found matching selector: ${o}`),{cleanup(){}};if(!("IntersectionObserver"in window))return console.error("IntersectionObserver not available: playing all videos as fallback."),e.forEach(e=>{m(e),d(e)&&(u(e),e.classList.add("js-video__visible"),e.parentElement?.classList.add("js-video-ready"),b(e))}),{cleanup(){}};i=new IntersectionObserver(v,{root:null,rootMargin:"200px 0px",threshold:.4}),e.forEach(e=>i.observe(e)),document.addEventListener("visibilitychange",f)}()})})()})();
//# sourceMappingURL=main.min.js.map