{"version":3,"file":"main.min.js","mappings":"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","sources":["webpack://wp-boilerplate/./src/js/modules/_animation-observer.js","webpack://wp-boilerplate/./src/js/modules/_video-observer.js","webpack://wp-boilerplate/./src/js/modules/_mobile-nav.js","webpack://wp-boilerplate/./src/js/main.js"],"sourcesContent":["let elementsToObserve;\nlet options;\nlet observer;\n\nfunction cacheDOM() {\n    elementsToObserve = [...document.querySelectorAll('.js-anim')];\n}\n\nexport function observerCallback(entries) {\n    entries.forEach(entry => {\n        if (entry.isIntersecting) {\n            entry.target.classList.add('js-anim__visible');\n            observer.unobserve(entry.target);\n        }\n    });\n}\n\nexport function cleanup() {\n    if (observer) {\n        observer.disconnect();\n        observer = null;\n    }\n}\n\nexport function reinit() {\n    init();\n}\n\nexport default function init() {\n    // Cleanup any existing observers\n    cleanup();\n    cacheDOM();\n    if (elementsToObserve.length) {\n        if (!('IntersectionObserver' in window)) {\n            // Check if the API is available, if not, add the classes to display all items\n            console.error('Intersection Observer API is not available. Fallbacks are being used.');\n            elementsToObserve.forEach(element => element.classList.add('js-anim__visible'));\n        } else {\n            options = {\n                root: null,\n                rootMargin: \"0px\",\n                threshold: 0.25\n            };\n\n            observer = new IntersectionObserver(observerCallback, options);\n            elementsToObserve.forEach(element => {\n                if (!element || !(element instanceof Element)) {\n                    console.error('Invalid DOM element', element);\n                    return;\n                } else {\n                    observer.observe(element);\n                }\n            });\n        }\n    }\n}","/**\n * Auto-play/pause <video> when it enters/leaves the viewport.\n * - Lazy-loads <source data-src> â†’ source.src on first intersect\n * - Respects prefers-reduced-motion (disables autoplay)\n * - Works with iOS/Safari autoplay policy (muted + playsinline)\n * - Guards against repeated play() calls\n * - Pauses when tab is hidden\n * - Exposes a cleanup() to disconnect the observer\n */\n\nconst VIDEO_SELECTOR = '.js-video';\n\nlet observer;\n\nfunction shouldAutoplay(video) {\n    if (video.dataset.autoplay === 'false') return false;\n    // Respect reduced motion\n    const reduced = window.matchMedia?.('(prefers-reduced-motion: reduce)').matches;\n    if (reduced) return false;\n\n    return true;\n}\n\nfunction primeForAutoplay(video) {\n    // iOS/Safari require muted + playsinline for autoplay\n    if (!video.hasAttribute('muted')) video.muted = true;\n    if (!video.hasAttribute('playsinline')) video.setAttribute('playsinline', '');\n\n    // Avoid unexpected audio; allow override via data-unmute=\"true\"\n    if (video.dataset.unmute === 'true') {\n        video.muted = false; // only if authors explicitly opt-in\n    }\n}\n\n/** Lazy-load <source data-src> only once */\nfunction lazyLoadSources(video) {\n    if (video.hasAttribute('data-loaded')) return;\n\n    const sources = Array.from(video.children).filter(el => el.tagName === 'SOURCE');\n    let changed = false;\n\n    for (const source of sources) {\n        const dataSrc = source.getAttribute('data-src');\n        if (!dataSrc) continue;\n        source.src = dataSrc;\n        source.removeAttribute('data-src');\n        changed = true;\n    }\n\n    if (changed) {\n        video.load();\n    }\n\n    // Mark as processed when metadata is ready\n    if (!video.hasAttribute('data-loaded')) {\n        const onMeta = () => {\n            video.setAttribute('data-loaded', 'true');\n            video.removeEventListener('loadedmetadata', onMeta);\n        };\n        video.addEventListener('loadedmetadata', onMeta, { once: true });\n    }\n}\n\n/** Play with guard to reduce noisy errors in consoles */\nasync function safePlay(video) {\n    // Avoid repeated play() spam while already playing\n    if (!video.paused && !video.ended) return;\n\n    try {\n        await video.play();\n    } catch (err) {\n        console.debug('Video play() blocked or failed:', err?.name || err);\n    }\n}\n\n\nfunction handleIntersect(entries) {\n    entries.forEach(entry => {\n        const video = entry.target;\n\n        if (entry.isIntersecting) {\n            lazyLoadSources(video);\n\n            if (!shouldAutoplay(video)) return;\n\n            primeForAutoplay(video);\n\n            video.classList.add('js-video__visible');\n            video.parentElement?.classList.add('js-video-ready');\n            safePlay(video);\n        } else {\n            video.classList.remove('js-video__visible');\n            // Guard: only pause if not already paused\n            if (!video.paused) {\n                video.pause();\n            }\n        }\n    });\n}\n\n/** Pause everything if the tab is hidden; resume visible ones on return */\nfunction handleVisibilityChange() {\n    const videos = document.querySelectorAll(VIDEO_SELECTOR);\n    if (document.hidden) {\n        videos.forEach(v => { if (!v.paused) v.pause(); });\n    } else {\n        // Let the observer drive resume; no action needed here\n    }\n}\n\n\n/**\n * Initialise the video observer.\n * @param {IntersectionObserverInit} [opts]\n * @returns {{ cleanup: () => void }}\n */\nexport default function init(opts) {\n    const elements = Array.from(document.querySelectorAll(VIDEO_SELECTOR))\n        .filter(el => el instanceof HTMLVideoElement);\n\n    if (!elements.length) {\n        console.warn(`No video elements found matching selector: ${VIDEO_SELECTOR}`);\n        return { cleanup() { } };\n    }\n\n    // Fallback if IntersectionObserver is unavailable\n    if (!('IntersectionObserver' in window)) {\n        console.error('IntersectionObserver not available: playing all videos as fallback.');\n        elements.forEach(video => {\n            lazyLoadSources(video);\n            if (!shouldAutoplay(video)) return;\n            primeForAutoplay(video);\n            video.classList.add('js-video__visible');\n            video.parentElement?.classList.add('js-video-ready');\n            safePlay(video);\n        });\n        return { cleanup() { } };\n    }\n\n    const options = {\n        root: null,\n        // Preload a touch before entering; 200px tends to feel nicer than 50px\n        rootMargin: '200px 0px',\n        // 0.4 is fine; if videos are tall, consider 0.25 for snappier starts\n        threshold: 0.4,\n        ...opts\n    };\n\n    observer = new IntersectionObserver(handleIntersect, options);\n    elements.forEach(video => observer.observe(video));\n\n    // Tab visibility handling\n    document.addEventListener('visibilitychange', handleVisibilityChange);\n\n    // Provide a teardown for SPA/unmount cases\n    const cleanup = () => {\n        try {\n            observer?.disconnect();\n        } catch { }\n        document.removeEventListener('visibilitychange', handleVisibilityChange);\n    };\n\n    return { cleanup };\n}","// import { closeSearchPane } from './searchPane';\n\nlet $mobileNav;\nlet $subNavs;\nlet $burger;\nlet $closeBtns;\nlet $DEBUG = false;\nconst ANIMATION_DURATION = 300;\nconst SUB_MENU_TRANSITION = `height ${ANIMATION_DURATION}ms ease-in-out`;\nlet navigationTimeout;\n\nfunction cacheDOM() {\n  $mobileNav = document.querySelector('.js-mobile-nav');\n  $burger = document.querySelector('.js-mobile-nav__burger');\n\n  if ($mobileNav) {\n    $subNavs = [...$mobileNav.querySelectorAll('.js-mobile-nav__toggle')];\n    $closeBtns = [...$mobileNav.querySelectorAll('.js-mobile-nav__close')];\n  } else {\n    $subNavs = [];\n    $closeBtns = [];\n  }\n}\n\nfunction openMainNav() {\n    document.body.classList.add('mobile-nav-primer');\n    clearTimeout(navigationTimeout);\n    navigationTimeout = setTimeout(() => {\n        document.body.classList.add('mobile-nav-open');\n        $DEBUG = false;\n    }, ANIMATION_DURATION);\n}\n\nexport function closeMainNav() {\n    clearTimeout(navigationTimeout);\n    document.body.classList.remove('mobile-nav-open');\n    setTimeout(() => {\n        document.body.classList.remove('mobile-nav-primer');\n        $DEBUG = false;\n    }, ANIMATION_DURATION);\n}\n\nfunction toggleMobileNav() {\n    if ($DEBUG) return;\n\n    $DEBUG = true;\n\n    if (document.body.classList.contains('search-pane-open')) {\n        // closeSearchPane();\n        openMainNav();\n    } else {\n        if (document.body.classList.contains('mobile-nav-open')) {\n            closeMainNav();\n        } else {\n            openMainNav();\n        }\n    }\n\n}\n\nfunction calculateTotalHeight(element) {\n    let totalHeight = element.scrollHeight;\n\n    return totalHeight;\n}\n\nfunction toggleSubNav(event) {\n    if ($DEBUG) return;\n\n    const $trigger = event;\n    const submenu = $trigger.querySelector('.sub-menu');\n\n    if (!submenu) return;\n\n    submenu.style.transition = SUB_MENU_TRANSITION;\n\n    if ($trigger.classList.contains('sub-menu__open')) {\n        submenu.style.height = '0';\n\n        submenu.addEventListener('transitionend', () => {\n            submenu.style.transition = '';\n            submenu.style.height = '';\n            $trigger.classList.remove('sub-menu__open');\n        }, { once: true });\n\n    } else {\n        const height = calculateTotalHeight(submenu) + 'px';  // Update this line\n        submenu.style.height = height;\n        $trigger.classList.add('sub-menu__open');\n\n        submenu.addEventListener('transitionend', () => {\n            submenu.style.transition = '';\n        }, { once: true });\n    }\n    $DEBUG = false;\n}\n\nfunction bindEvents() {\n    if ($burger) {\n        $burger.addEventListener('click', toggleMobileNav);\n    } else {\n        console.warn(\"Expected .js-mobile-nav__burger element is missing.\");\n    }\n\n    if ($subNavs.length) {\n        $subNavs.forEach(subNav => {\n            subNav.closest('.menu-item').addEventListener('click', function (event) {\n                if (event.target.closest('.menu-item').classList.contains('menu-item-has-children')) {\n                    event.stopPropagation(); \n                    event.preventDefault();\n                    toggleSubNav(event.currentTarget);\n                } else {\n                    return;\n                }\n            });   \n\n            // Uncomment the following lines if you want to handle clicks on the subNav Icon itself\n            // subNav.addEventListener('click', function (event) {\n            //     event.stopPropagation();\n\n            //     if (event.target.closest('.menu-item').classList.contains('menu-item-has-children')) {\n            //         const clickParent = event.target.closest('.menu-item');\n            //         event.preventDefault();\n            //         toggleSubNav(clickParent);\n            //     } else {\n            //         return;\n            //     }\n            // });\n        });\n    }\n\n    if ($closeBtns.length) {\n        $closeBtns.forEach(closeBtn => {\n            closeBtn.addEventListener('click', function () {\n                toggleMobileNav();\n            });\n        });\n\n    }\n}\n\nexport default function init() {\n    cacheDOM();\n\n    if ($mobileNav) {\n        bindEvents();\n    } else {\n        console.warn(\"Expected .js-mobile-nav element is missing.\");\n    }\n}","// import Splides from './modules/_splides';\nimport animationObserver from './modules/_animation-observer';\nimport videoObserver from './modules/_video-observer';\nimport mobileNav from './modules/_mobile-nav';\n\nwindow.addEventListener('DOMContentLoaded', () => {\n    animationObserver();\n    mobileNav();\n    videoObserver();\n    // Splides();\n});"],"names":["elementsToObserve","options","observer","observerCallback","entries","forEach","entry","isIntersecting","target","classList","add","unobserve","VIDEO_SELECTOR","$mobileNav","$subNavs","$burger","$closeBtns","shouldAutoplay","video","dataset","autoplay","reduced","window","matchMedia","matches","primeForAutoplay","hasAttribute","muted","setAttribute","unmute","lazyLoadSources","sources","Array","from","children","filter","el","tagName","changed","source","dataSrc","getAttribute","src","removeAttribute","load","onMeta","removeEventListener","addEventListener","once","async","safePlay","paused","ended","play","err","console","debug","name","handleIntersect","parentElement","remove","pause","handleVisibilityChange","videos","document","querySelectorAll","hidden","v","navigationTimeout","$DEBUG","openMainNav","body","clearTimeout","setTimeout","toggleMobileNav","contains","init","querySelector","warn","length","subNav","closest","event","stopPropagation","preventDefault","$trigger","submenu","style","transition","height","scrollHeight","toggleSubNav","currentTarget","closeBtn","disconnect","root","rootMargin","threshold","IntersectionObserver","element","Element","observe","error","mobileNav","elements","HTMLVideoElement","cleanup","videoObserver"],"sourceRoot":""}