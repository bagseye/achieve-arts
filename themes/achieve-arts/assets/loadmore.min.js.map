{"version":3,"file":"loadmore.min.js","mappings":"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","sources":["webpack://wp-boilerplate/./src/js/modules/_animation-observer.js","webpack://wp-boilerplate/./src/js/loadmore.js"],"sourcesContent":["let elementsToObserve;\nlet options;\nlet observer;\n\nfunction cacheDOM() {\n    elementsToObserve = [...document.querySelectorAll('.js-anim')];\n}\n\nexport function observerCallback(entries) {\n    entries.forEach(entry => {\n        if (entry.isIntersecting) {\n            entry.target.classList.add('js-anim__visible');\n            observer.unobserve(entry.target);\n        }\n    });\n}\n\nexport function cleanup() {\n    if (observer) {\n        observer.disconnect();\n        observer = null;\n    }\n}\n\nexport function reinit() {\n    init();\n}\n\nexport default function init() {\n    // Cleanup any existing observers\n    cleanup();\n    cacheDOM();\n    if (elementsToObserve.length) {\n        if (!('IntersectionObserver' in window)) {\n            // Check if the API is available, if not, add the classes to display all items\n            console.error('Intersection Observer API is not available. Fallbacks are being used.');\n            elementsToObserve.forEach(element => element.classList.add('js-anim__visible'));\n        } else {\n            options = {\n                root: null,\n                rootMargin: \"0px\",\n                threshold: 0.25\n            };\n\n            observer = new IntersectionObserver(observerCallback, options);\n            elementsToObserve.forEach(element => {\n                if (!element || !(element instanceof Element)) {\n                    console.error('Invalid DOM element', element);\n                    return;\n                } else {\n                    observer.observe(element);\n                }\n            });\n        }\n    }\n}","import animationObserver from './modules/_animation-observer.js';\n\nlet currentPage = parseInt(loadmore_params.current_page);\nlet maxPages = parseInt(loadmore_params.max_page);\nlet loading = false;\nlet observer;\nlet currentCategoryId = '';\n\nfunction loadMorePosts() {\n    if (loading || currentPage >= maxPages) return;\n    \n    loading = true;\n    const loadingIndicator = document.querySelector('.loading-indicator');\n    \n    if (loadingIndicator) {\n        loadingIndicator.style.display = 'block';\n    }\n\n    const data = new FormData();\n    data.append('action', 'load_more_posts');\n    data.append('page', currentPage + 1);\n    data.append('category_id', currentCategoryId);\n\n    fetch(loadmore_params.ajaxurl, {\n        method: 'POST',\n        body: data\n    })\n    .then(response => response.json())\n    .then(data => {\n        if (data.posts) {\n            const contentContainer = document.getElementById('site-content');\n            contentContainer.insertAdjacentHTML('beforeend', data.posts);\n            \n            currentPage = parseInt(data.current_page);\n            maxPages = parseInt(data.max_page);\n            \n            animationObserver();\n            \n            if (currentPage >= maxPages) {\n                const trigger = document.getElementById('load-more-trigger');\n                if (trigger) {\n                    trigger.style.display = 'none';\n                }\n                if (observer) {\n                    observer.disconnect();\n                }\n            }\n        }\n    })\n    .catch(error => {\n        console.error('Error loading posts:', error);\n    })\n    .finally(() => {\n        loading = false;\n        const loadingIndicator = document.querySelector('.loading-indicator');\n        if (loadingIndicator) {\n            loadingIndicator.style.display = 'none';\n        }\n    });\n}\n\nfunction filterPosts(categoryId) {\n    loading = true;\n    currentCategoryId = categoryId;\n    currentPage = 1;\n    \n    const loadingIndicator = document.querySelector('.loading-indicator');\n    if (loadingIndicator) {\n        loadingIndicator.style.display = 'block';\n    }\n\n    const data = new FormData();\n    data.append('action', 'load_more_posts');\n    data.append('page', 1);\n    data.append('category_id', categoryId);\n\n    fetch(loadmore_params.ajaxurl, {\n        method: 'POST',\n        body: data\n    })\n    .then(response => response.json())\n    .then(data => {\n        if (data.posts) {\n            // Replace all content with filtered posts\n            const contentContainer = document.getElementById('site-content');\n            contentContainer.innerHTML = data.posts;\n            \n            currentPage = parseInt(data.current_page);\n            maxPages = parseInt(data.max_page);\n            \n            animationObserver();\n            \n            // Show/hide trigger based on available pages\n            const trigger = document.getElementById('load-more-trigger');\n            if (trigger) {\n                if (currentPage >= maxPages) {\n                    trigger.style.display = 'none';\n                } else {\n                    trigger.style.display = 'block';\n                    // Restart infinite scroll observer\n                    initInfiniteScroll();\n                }\n            }\n        }\n    })\n    .catch(error => {\n        console.error('Error filtering posts:', error);\n    })\n    .finally(() => {\n        loading = false;\n        const loadingIndicator = document.querySelector('.loading-indicator');\n        if (loadingIndicator) {\n            loadingIndicator.style.display = 'none';\n        }\n    });\n}\n\nfunction initInfiniteScroll() {\n    const trigger = document.getElementById('load-more-trigger');\n    \n    if (!trigger || currentPage >= maxPages) return;\n    \n    // Disconnect existing observer if it exists\n    if (observer) {\n        observer.disconnect();\n    }\n\n    const options = {\n        root: null,\n        rootMargin: '100px',\n        threshold: 0.1\n    };\n\n    observer = new IntersectionObserver((entries) => {\n        entries.forEach(entry => {\n            if (entry.isIntersecting && !loading) {\n                loadMorePosts();\n            }\n        });\n    }, options);\n\n    observer.observe(trigger);\n}\n\nfunction initCategoryFilter() {\n    const categorySelect = document.getElementById('category-select');\n    \n    if (!categorySelect) return;\n    \n    categorySelect.addEventListener('change', function() {\n        const selectedCategory = this.value;\n        filterPosts(selectedCategory);\n    });\n}\n\n// Initialize when DOM is ready\ndocument.addEventListener('DOMContentLoaded', function() {\n    // Initialize category filter\n    initCategoryFilter();\n    \n    // Initialize infinite scroll if supported\n    if ('IntersectionObserver' in window) {\n        initInfiniteScroll();\n    } else {\n        // Fallback: show a load more button\n        const trigger = document.getElementById('load-more-trigger');\n        if (trigger) {\n            trigger.innerHTML = '<button id=\"load-more-btn\" class=\"load-more-btn\">Load More Posts</button>';\n            const loadMoreBtn = document.getElementById('load-more-btn');\n            if (loadMoreBtn) {\n                loadMoreBtn.addEventListener('click', loadMorePosts);\n            }\n        }\n    }\n});"],"names":["elementsToObserve","options","observer","observerCallback","entries","forEach","entry","isIntersecting","target","classList","add","unobserve","init","disconnect","document","querySelectorAll","length","window","root","rootMargin","threshold","IntersectionObserver","element","Element","observe","console","error","currentPage","parseInt","loadmore_params","current_page","maxPages","max_page","loading","currentCategoryId","loadMorePosts","loadingIndicator","querySelector","style","display","data","FormData","append","fetch","ajaxurl","method","body","then","response","json","posts","getElementById","insertAdjacentHTML","animationObserver","trigger","catch","finally","initInfiniteScroll","addEventListener","categorySelect","categoryId","innerHTML","filterPosts","this","value","initCategoryFilter","loadMoreBtn"],"sourceRoot":""}